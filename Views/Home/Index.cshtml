@{
    ViewData["Title"] = "Trang chủ";
}
@{
    var topProjects = ViewBag.TopProjects as List<StudentFreelance.Models.Project>;
}
@section Styles {
    <link rel="stylesheet" href="~/css/home/home.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
}

<!-- Hero Section -->
<section class="hero-slideshow">
    <!-- Slideshow Background -->
    <div class="slideshow-container">
        @{
            var defaultImages = new List<string> { "bg1.png", "bg2.png", "bg3.png", "bg4.png", "bg5.png", "bg6.png" };
            var advertisements = ViewBag.Advertisements as List<StudentFreelance.Models.Advertisement> ?? new List<StudentFreelance.Models.Advertisement>();
            
            // Display advertisements first
            foreach (var ad in advertisements)
            {
                string imageUrl = $"~/uploads/advertisements/{ad.ImagePath}";
                string linkUrl = $"/User/Profile/{ad.BusinessId}";
                bool isFirst = ad == advertisements.FirstOrDefault();
                
                <div class="slide @(isFirst ? "active" : "")" style="background-image: url('@Url.Content(imageUrl)')">
                    <a href="@linkUrl" class="ad-link" title="Xem thêm về @ad.Business.CompanyName"></a>
                </div>
            }
            
            // If there are fewer than 6 ads, display default images to fill up to 6 slides
            if (advertisements.Count < 6)
            {
                for (int i = 0; i < Math.Min(6 - advertisements.Count, defaultImages.Count); i++)
                {
                    bool isFirst = advertisements.Count == 0 && i == 0;
                    <div class="slide @(isFirst ? "active" : "")" style="background-image: url('@Url.Content($"~/image/{defaultImages[i]}")')"></div>
                }
            }
        }
        
        <!-- Navigation arrows -->
        <button class="slideshow-prev" aria-label="Previous slide">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button class="slideshow-next" aria-label="Next slide">
            <i class="fas fa-chevron-right"></i>
        </button>
        
        <!-- Slide indicators -->
        <div class="slideshow-dots">
            @{
                int totalSlides = advertisements.Count;
                if (totalSlides < 6)
                {
                    totalSlides += Math.Min(6 - advertisements.Count, defaultImages.Count);
                }
                
                for (int i = 0; i < totalSlides; i++)
                {
                    <span class="slideshow-dot @(i == 0 ? "active" : "")" data-slide="@i"></span>
                }
            }
        </div>
    </div>

    <!-- Nội dung -->
    <div class="hero-container" style="pointer-events: none;">
        <div class="hero-content" style="pointer-events: auto;">
            <h1 class="hero-title">Let top talent bring your ideas to life</h1>

            <div class="popular-searches">
                <a asp-controller="Search" asp-action="SearchJob" asp-route-query="website development" class="tag">website development</a>
                <a asp-controller="Search" asp-action="SearchJob" asp-route-query="architecture & interior design" class="tag">architecture & interior design</a>
                <a asp-controller="Search" asp-action="SearchJob" asp-route-query="UGC videos" class="tag">UGC videos</a>
                <a asp-controller="Search" asp-action="SearchJob" asp-route-query="video editing" class="tag">video editing</a>
            </div>

            <!-- Trusted By -->
            <div class="trusted-by">
                <span class="trusted-text">Trusted by:</span>
                <div class="trusted-companies">
                    <span>Meta</span>
                    <span>Google</span>
                    <span>Netflix</span>
                    <span>P&G</span>
                    <span>PayPal</span>
                    <span>Payoneer</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Top Projects Section -->
<section class="top-projects">
    <div class="container">
        <div class="section-header">
            <h2>Top Projects</h2>
            <a href="@Url.Action("Index", "Project")" class="view-all-btn">View all</a>
        </div>

        <div class="projects-grid">
            @foreach (var project in topProjects)
            {
                <a asp-controller="Project" asp-action="Details" asp-route-id="@project.ProjectID" class="text-decoration-none text-dark">
                    <div class="project-card">
                        <div class="project-image">
                            <img src="~/image/project-default.jpg" alt="@project.Business?.FullName" />
                        </div>
                        <div class="project-content">
                            <h3 class="project-title">@project.Title</h3>
                            <p class="company-name">@project.Business?.FullName</p>
                            <div class="project-meta">
                                <span class="salary">@($"{project.Budget:N0} đ")</span>
                                <span class="location">
                                    @(project.IsRemoteWork ? "Remote" : project.Address?.ProvinceName ?? "Unidentified location")
                                </span>
                            </div>
                            <div class="project-status hot">Hot</div>
                        </div>
                    </div>
                </a>
            }
        </div>
    </div>
</section>

<script>
    // Pagination functionality
    const prevBtn = document.querySelector('.pagination-btn.prev');
    const nextBtn = document.querySelector('.pagination-btn.next');
    const dots = document.querySelectorAll('.dot');
    let currentPage = 0;
    const totalPages = dots.length;

    function updatePagination() {
        // Update dots
        dots.forEach((dot, index) => {
            dot.classList.toggle('active', index === currentPage);
        });

        // Update buttons
        prevBtn.disabled = currentPage === 0;
        nextBtn.disabled = currentPage === totalPages - 1;
    }

    prevBtn.addEventListener('click', () => {
        if (currentPage > 0) {
            currentPage--;
            updatePagination();
        }
    });

    nextBtn.addEventListener('click', () => {
        if (currentPage < totalPages - 1) {
            currentPage++;
            updatePagination();
        }
    });

    dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
            currentPage = index;
            updatePagination();
        });
    });

    // Initialize pagination
    updatePagination();
</script>

<!-- Categories Section -->
<section class="categories">
    <div class="container">
        <div class="categories-grid">
            <div class="category-item">
                <div class="category-icon">
                    <i class="fas fa-code"></i>
                </div>
                <div class="category-text">
                    <span>Programming</span>
                    <span>& Tech</span>
                </div>
            </div>
            <div class="category-item">
                <div class="category-icon">
                    <i class="fas fa-palette"></i>
                </div>
                <div class="category-text">
                    <span>Graphics &</span>
                    <span>Design</span>
                </div>
            </div>
            <div class="category-item">
                <div class="category-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="category-text">
                    <span>Digital</span>
                    <span>Marketing</span>
                </div>
            </div>
            <div class="category-item">
                <div class="category-icon">
                    <i class="fas fa-pen-fancy"></i>
                </div>
                <div class="category-text">
                    <span>Writing &</span>
                    <span>Translation</span>
                </div>
            </div>
            <div class="category-item">
                <div class="category-icon">
                    <i class="fas fa-video"></i>
                </div>
                <div class="category-text">
                    <span>Video &</span>
                    <span>Animation</span>
                </div>
            </div>
            <div class="category-item">
                <div class="category-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="category-text">
                    <span>AI Services</span>
                </div>
            </div>
            <div class="category-item">
                <div class="category-icon">
                    <i class="fas fa-music"></i>
                </div>
                <div class="category-text">
                    <span>Music & Audio</span>
                </div>
            </div>
            <div class="category-item">
                <div class="category-icon">
                    <i class="fas fa-briefcase"></i>
                </div>
                <div class="category-text">
                    <span>Business</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Popular Services Section -->
<section class="popular-services">
    <div class="container">
        <div class="section-header">
            <h2>Popular Business</h2>
            <button class="arrow-btn">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        <div class="services-grid">
            <div class="service-card green">
                <div class="card-content">
                    <h3>ABC Comapny</h3>
                </div>
                <div class="card-image">
                    <img src="https://images.unsplash.com/photo-1547658719-da2b51169166?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                         alt="ABC Comapny" />
                </div>
            </div>
            <div class="service-card pink">
                <div class="card-content">
                    <h3>Flower Restaurant</h3>
                </div>
                <div class="card-image">
                    <img src="https://images.unsplash.com/photo-1574717024653-61fd2cf4d44d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                         alt="Flower Restaurant" />
                </div>
            </div>
            <div class="service-card orange">
                <div class="card-content">
                    <h3>FPT Software</h3>
                </div>
                <div class="card-image">
                    <img src="https://images.unsplash.com/photo-1555066931-4365d14bab8c?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                         alt="FPT Software" />
                </div>
            </div>
            <div class="service-card teal">
                <div class="card-content">
                    <h3>Golden Gate</h3>
                </div>
                <div class="card-image">
                    <img src="https://images.unsplash.com/photo-1432888622747-4eb9a8c2b156?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                         alt="Golden Gate" />
                </div>
            </div>
            <div class="service-card purple">
                <div class="card-content">
                    <h3>MTP Entertainment</h3>
                </div>
                <div class="card-image">
                    <img src="https://images.unsplash.com/photo-1586023492125-27b2c045efd7?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                         alt="MTP Entertainment" />
                </div>
            </div>
            <div class="service-card yellow">
                <div class="card-content">
                    <h3>Malisa Cosmetic</h3>
                </div>
                <div class="card-image">
                    <img src="https://images.unsplash.com/photo-1481627834876-b7833e8f5570?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                         alt="Malisa Cosmetic" />
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Enterprise Section -->
<section class="enterprise">
    <div class="container">
        <div class="enterprise-content">
            <div class="enterprise-text">
                <button class="btn btn-secondary">Enterprise Suite</button>
                @* <button  class="enterprise-tag"></button> *@
                <h2 class="enterprise-title">
                    This is how<br />
                    <span class="highlight">good companies</span><br />
                    find good company.
                </h2>
                <p class="enterprise-description">
                    Access the top 1% of talent on STJobs, and a full suite of hybrid
                    workforce management tools. This is how innovation works now.
                </p>
                <div class="enterprise-features">
                    <div class="feature">
                        <i class="fas fa-check"></i>
                        <span>Access expert talent to fill your skill gaps</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-check"></i>
                        <span>
                            Control your workflow: hire, classify and pay your
                            talent
                        </span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-check"></i>
                        <span>Partner with Upwork for end-to-end support</span>
                    </div>
                </div>
                <button class="btn btn-secondary">Learn more</button>
            </div>
            <div class="enterprise-image">
                <img src="https://images.unsplash.com/photo-1573164713714-d95e436ab8d6?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                     alt="Professional working" />
                <div class="stat-card stat-card-1">
                    <i class="fas fa-users"></i>
                    <div>
                        <div class="stat-number">500+</div>
                        <div class="stat-label">Enterprise clients</div>
                    </div>
                </div>
                <div class="stat-card stat-card-2">
                    <i class="fas fa-briefcase"></i>
                    <div>
                        <div class="stat-number">10M+</div>
                        <div class="stat-label">Projects completed</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Find Talent Section -->
<section class="find-talent">
    <div class="container">
        <div class="find-talent-card">
            <button class="btn btn-secondary">For client</button>
            <div class="find-talent-content">
                <h2>Find talent<br />your way</h2>
                <p>
                    Work with the largest network of independent professionals and get
                    things done—from quick turnarounds to big transformations.
                </p>
            </div>
        </div>
    </div>
</section>
    </main>
<div id="footer"></div>

<script>
        // Slideshow functionality
        document.addEventListener('DOMContentLoaded', function() {
            const slides = document.querySelectorAll('.slide');
            const dots = document.querySelectorAll('.slideshow-dot');
            const prevButton = document.querySelector('.slideshow-prev');
            const nextButton = document.querySelector('.slideshow-next');
            const slideshowContainer = document.querySelector('.slideshow-container');
            let current = 0;
            let timer;
            let touchStartX = 0;
            let touchEndX = 0;
            
            // Initialize slideshow
            function showSlide(index) {
                if (!slides || slides.length === 0) return;
                
                // Ensure index is within bounds
                if (index >= slides.length) index = 0;
                if (index < 0) index = slides.length - 1;
                
                // Remove active class from all slides and dots
                slides.forEach(slide => {
                    slide.classList.remove('active');
                });
                
                dots.forEach(dot => dot.classList.remove('active'));
                
                // Add active class to current slide and dot
                slides[index].classList.add('active');
                if (dots[index]) {
                    dots[index].classList.add('active');
                }
                
                // Update current index
                current = index;
                
                console.log('Changed to slide', index);
            }
            
            // Next slide
            function nextSlide() {
                if (!slides || slides.length === 0) return;
                
                let next = (current + 1) % slides.length;
                showSlide(next);
            }
            
            // Previous slide
            function prevSlide() {
                if (!slides || slides.length === 0) return;
                
                let prev = current - 1;
                if (prev < 0) prev = slides.length - 1;
                showSlide(prev);
            }
            
            // Start timer for automatic slideshow
            function startTimer() {
                clearInterval(timer);
                timer = setInterval(nextSlide, 5000);
            }
            
            // Reset timer when user interacts with slideshow
            function resetTimer() {
                clearInterval(timer);
                startTimer();
            }
            
            // Touch support for mobile devices
            if (slideshowContainer) {
                slideshowContainer.addEventListener('touchstart', function(e) {
                    touchStartX = e.changedTouches[0].screenX;
                }, {passive: true});
                
                slideshowContainer.addEventListener('touchend', function(e) {
                    touchEndX = e.changedTouches[0].screenX;
                    handleSwipe();
                }, {passive: true});
            }
            
            function handleSwipe() {
                let swipeDistance = touchEndX - touchStartX;
                
                if (Math.abs(swipeDistance) > 50) {
                    if (swipeDistance > 0) {
                        prevSlide();
                    } else {
                        nextSlide();
                    }
                    resetTimer();
                }
            }
            
            // Event listeners
            if (prevButton) {
                prevButton.addEventListener('click', function() {
                    prevSlide();
                    resetTimer();
                });
            }
            
            if (nextButton) {
                nextButton.addEventListener('click', function() {
                    nextSlide();
                    resetTimer();
                });
            }
            
            if (dots && dots.length > 0) {
                dots.forEach(function(dot, index) {
                    dot.addEventListener('click', function() {
                        showSlide(index);
                        resetTimer();
                    });
                });
            }
            
            // Pause slideshow on hover
            if (slideshowContainer) {
                slideshowContainer.addEventListener('mouseenter', function() {
                    clearInterval(timer);
                });
                
                slideshowContainer.addEventListener('mouseleave', function() {
                    startTimer();
                });
            }
            
            // Initialize slideshow
            if (slides && slides.length > 0) {
                showSlide(0);
                startTimer();
                console.log('Slideshow initialized with', slides.length, 'slides');
            }
        });
    </script>
</script>

<script>
    // Load header and footer if needed
    const headerEl = document.getElementById('header');
    const footerEl = document.getElementById('footer');
    
    if (headerEl) {
      fetch('header.html')
        .then(res => res.text())
        .then(data => headerEl.innerHTML = data)
        .catch(err => console.log('Error loading header:', err));
    }
    
    if (footerEl) {
      fetch('footer.html')
        .then(res => res.text())
        .then(data => footerEl.innerHTML = data)
        .catch(err => console.log('Error loading footer:', err));
    }
</script>
