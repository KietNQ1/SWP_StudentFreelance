@model IEnumerable<StudentFreelance.Models.Notification>

<link rel="stylesheet" href="~/css/notification/index.css" asp-append-version="true" />

@{
    ViewData["Title"] = "Thông báo của tôi";
}

<div class="notification-container">
    <h2 class="notification-title">🔔 Thông báo của bạn</h2>

    @if (!Model.Any())
    {
        <div class="alert-info">Bạn chưa có thông báo nào.</div>
    }
    else
    {
        <form asp-action="MarkAllAsRead" method="post">
            <button class="btn-mark-all" type="submit">✔ Đánh dấu tất cả là đã đọc</button>
        </form>

        <ul class="notification-list">
            @foreach (var item in Model)
            {
                var userNotification = item.UserNotifications.FirstOrDefault();
                var isRead = userNotification?.IsRead ?? false;

                <li class="notification-item @(isRead ? "" : "unread")">
                    <div>
                        <div class="fw-bold">
                            <a asp-action="Details" asp-route-id="@item.NotificationID">
                                @item.Title
                            </a>
                        </div>
                        <div class="notification-meta">
                            📅 @item.NotificationDate.ToString("dd/MM/yyyy HH:mm")
                            | 👤 @(item.Sender?.FullName ?? "Hệ thống")
                            | 🏷️ @item.Type?.TypeName
                        </div>
                    </div>

                    @if (!isRead)
                    {
                        <form asp-action="MarkAsRead" method="post" asp-route-id="@item.NotificationID">
                            <button class="btn-mark-read">✔ Đã đọc</button>
                        </form>
                    }
                </li>
            }
        </ul>
    }
</div>
